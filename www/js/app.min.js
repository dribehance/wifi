angular.module("Wifi",["ngRoute","LocalStorageModule"]).config(["$routeProvider","$httpProvider","$locationProvider","localStorageServiceProvider","config",function(e,t,n,r,o){angular.forEach(o.interceptor,function(t){var n=t.replace(/_[a-z]/g,function(e){return e.split("_")[1].toUpperCase()});n+="Controller",e.when("/"+t,{templateUrl:"templates/"+t+".html",reloadOnSearch:!1,controller:n,resolve:{user:["$q","$location","localStorageService",function(e,n,r){var o=["account"],i=e.defer();return o.includes(t)&&!r.get("token")?(i.reject(),n.path("/signin").replace(),void 0):(i.resolve(),i.promise)}]}})}),e.otherwise("/index"),t.defaults.useXDomain=!0,t.defaults.withCredentials=!0,delete t.defaults.headers.common["X-Requested-With"],r.setStorageCookie(.02),t.interceptors.push("tokenInterceptor")}]).run(["appServices",function(e){e.init()}]),angular.module("Wifi").factory("utilServices",["$q",function(e){var t=function(e){var t;t=e.split(",")[0].indexOf("base64")>=0?atob(e.split(",")[1]):unescape(e.split(",")[1]);for(var n=e.split(",")[0].split(":")[1].split(";")[0],r=new Uint8Array(t.length),o=0;o<t.length;o++)r[o]=t.charCodeAt(o);return new Blob([r],{type:n})},n=function(n){var r=e.defer(),o=document.createElement("img");try{var i=new FileReader;i.onload=function(e){o.src=e.target.result;var n=document.createElement("canvas"),i=n.getContext("2d");i.drawImage(o,0,0);var a=500,c=500,u=o.width,l=o.height;u>l?u>a&&(l*=a/u,u=a):l>c&&(u*=c/l,l=c),n.width=u,n.height=l;var i=n.getContext("2d");i.drawImage(o,0,0,u,l);var s=n.toDataURL("image/jpeg"),d=t(s);r.resolve(d)},i.readAsDataURL(n)}catch(a){r.resolve(a)}return r.promise};return{resizeFile:n}}]),angular.module("Wifi").factory("userServices",["$rootScope","$http","apiServices","localStorageService","config",function(e,t,n,r,o){return{rsa_key:n._get(angular.extend({},o.common_params,{url:"key/private_key.pem"})),signin:n._get(angular.extend({},o.common_params,{url:o.url+"api_url"})),signup:n._get(angular.extend({},o.common_params,{url:o.url+"api_url"})),forget:n._get(angular.extend({},o.common_params,{url:o.url+"api_url"})),reset:n._get(angular.extend({},o.common_params,{url:o.url+"api_url"})),get_smscode:n._get(angular.extend({},o.common_params,{url:o.url+"api_url"})),query_basicinfo:n._get(angular.extend({},o.common_params,{url:o.url+"api_url",token:r.get("token")})),realname_authen:n._get(angular.extend({},o.common_params,{url:o.url+"api_url",token:r.get("token")})),phone_authen:n._get(angular.extend({},o.common_params,{url:o.url+"api_url",token:r.get("token")})),like:n._get(angular.extend({},o.common_params,{url:o.url+"api_url",token:r.get("token")})),unlike:n._get(angular.extend({},o.common_params,{url:o.url+"api_url",token:r.get("token")})),query_messages:n._get(angular.extend({},o.common_params,{url:o.url+"api_url",token:r.get("token")})),query_message_by_id:n._get(angular.extend({},o.common_params,{url:o.url+"api_url",token:r.get("token")}))}}]),angular.module("Wifi").factory("tokenInterceptor",["$location","$q","localStorageService","errorServices","config",function(e,t,n,r,o){return{request:function(e){return e},requestError:function(){},response:function(r){var i=t.defer();return r.config.url.indexOf(".html")>0?r:r.data.code==o.request.TOKEN_INVALID?(console.log("TOKEN_INVALID"),n.remove("token"),e.path("/signIn").replace(),i.promise):r},responseError:function(e){var n=t.defer();return r.requestError(e.data,e.status,e.headers,e.config),n.promise}}}]),angular.module("Wifi").factory("toastServices",function(){return{show:function(){$(".toast").show()},hide:function(){$(".toast").hide()},start:function(){NProgress.start()},done:function(){NProgress.done()}}}),angular.module("Wifi").factory("facebookServices",["$rootScope","$route","$http","$window","$location","$q","userServices","toastServices","errorServices","localStorageService","config",function(e,t,n,r,o,i,a,c,u,l,s){return r.fbAsyncInit=function(){var e=r.FB||void 0;e&&e.init({appId:"217442991983314",xfbml:!0,version:"v2.6"})},{share:function(e){var n=r.FB||void 0;n&&n.ui({method:"feed",link:e||s.share.link,redirect_uri:e||s.share.link,caption:s.share.title},function(){t.reload()})},login:function(){var e=i.defer(),t=this;return t._facebook_connected().then(function(e){return e}).then(function(){t._query_facebook_user_info().then(function(t){e.resolve(t)})}),e.promise},logout:function(){var e=r.FB||void 0;e&&e.logout(function(){})},_facebook_connected:function(){var e=i.defer(),t=r.FB||void 0;return t?(c.show(),t.login(function(t){c.hide(),"connected"==t.status?e.resolve(t):e.reject("_facebook_connected occured")},{scope:"public_profile,email"}),e.promise):void 0},_query_facebook_user_info:function(){var e=i.defer(),t=r.FB||void 0;return t?(t.api("/me",{fields:"id,email,name,picture,gender,last_name"},function(t){!t||t.error?e.reject("_query_facebook_user_info error occured"):e.resolve(t)}),e.promise):void 0}}}]),angular.module("Wifi").factory("errorServices",["$rootScope","$timeout","toastServices",function(e,t,n){return{show:function(t){e.error_msg=t,$(".error-msg").show()},hide:function(){e.error_msg="",$(".error-msg").hide()},autoHide:function(n){e.error_msg=n,$(".error-msg").show(),t(function(){e.error_msg="",$(".error-msg").hide()},3e3)},requestError:function(e,t,r,o){switch(n.hide(),t){case 0:this.autoHide("连接超时");break;case 500:case 501:case 502:case 503:case 504:case 505:case 506:case 507:case 509:case 510:this.autoHide("服务器连接出错")}console.log("onRequestError output status, data, headers, config"),console.log(t),console.log(e),console.log(r),console.log(o),console.log("onRequestError end")}}}]),angular.module("Wifi").factory("appServices",["$rootScope","$window","$location","errorServices","toastServices","config",function(e,t,n,r,o,i){var a=function(){},c=function(e,t,n){o.hide(),r.hide(),l(e,t,n)},u=function(){},l=function(){};return{init:function(){e.$on("$routeChangeStart",a),e.$on("$routeChangeSuccess",c),e.$on("$routeChangeError",u),e.go=function(e){n.path(e)},e.back=function(){t.history.back()},e.staticImageUrl=i.imageUrl}}}]),angular.module("Wifi").factory("apiServices",["$http",function(e){return{_get:function(t){return function(n){return void 0!==t.token&&(t.token=localStorageService.get("token")),e({url:t.url,method:"GET",params:angular.extend({},t,n)}).then(function(e){return e.data})}},_post:function(t){return function(n){return void 0!==t.token&&(t.token=localStorageService.get("token")),e({url:t.url,method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},transformRequest:function(e){var t=[];for(var n in e)t.push(encodeURIComponent(n)+"="+encodeURIComponent(e[n]));return t.join("&")},data:angular.extend({},t,n)}).then(function(e){return e.data})}}}}]),angular.module("Wifi").directive("onRepeatDone",function(){return{restrict:"A",link:function(e,t){e.$last&&e.$emit("onRepeatDone",t)}}}),angular.module("Wifi").directive("onload",function(){return{restrict:"A",link:function(e,t){$(t).css({opacity:0}),$(t).bind("load",function(){$(t).css({opacity:1})})}}}),angular.module("Wifi").directive("mobilepicker",["$timeout",function(e){return{restrict:"E",scope:{options:"="},template:"<input type='text' name='picker' readonly ng-model='options.value'>",link:function(t,n){var r={beginyear:1950,endyear:(new Date).getFullYear(),days:["周日","周一","周二","周三","周四","周五","周六"],curdate:!1,theme:"date",event:"click",callBack:function(e){t.options.value=e.y+"-"+e.M+"-"+e.d}};e(function(){$(n).find("input").datePicker(angular.extend({},r,t.options))},0)}}}]),angular.module("Wifi").directive("imageview",["$timeout",function(e){return{restrict:"E",scope:{src:"="},controller:["$scope","$element","$attrs",function(t,n,r){function o(e){$(e.target).css({width:"auto",height:"auto"});var n=$(e.target),r=n.width(),o=n.height(),i=parseFloat(r)/parseFloat(o);i<t.rate?(r=t.width,o=t.width/i,n.css({display:"inline-block",height:o,width:r,"margin-top":-(o-t.height)/2})):(o=t.height,r=o*i,n.css({display:"inline-block",height:o,width:r,"margin-left":-(r-t.width)/2})),n.parent().css({background:"none"}),n.css({visibility:"visible"})}function i(e){var n=$(e.target),r=n.width(),o=n.height(),i=parseFloat(r)/parseFloat(o);i<t.rate?n.css({display:"inline-block",height:"100%",width:"auto"}):n.css({display:"inline-block",height:"auto",width:"100%"}),n.parent().css({background:"none"}),n.css({visibility:"visible"})}return t.bg_image="../images/default.png",t.rate=parseFloat(t.$eval(r.rate)),t.width=n.parent().width()||$(window).width(),t.height=t.width/t.rate,t.rate?(this.show_center_on_loaded=function(t){o(t),e(function(){o(t)},100)},this.show_on_loaded=function(t){i(t),e(function(){i(t)},100)},void 0):(console.log("unexpect rate"),void 0)}],template:function(e){var t="<img ng-src='{{src}}' show-center-on-loaded err-src='../images/default.png'>";return void 0==$(e).attr("center-only")&&(t="<img ng-src='{{src}}' show-on-loaded err-src='../images/default.png'>"),t},link:function(e,t){var n={display:"block",width:e.width,overflow:"hidden","text-align":"center","background-image":"url("+e.bg_image+")","background-position":"center center","background-repeat":"no-repeat",height:e.height,overflow:"hidden"};$(t).css(n)}}}]).directive("showOnLoaded",function(){return{restrict:"A",require:"^imageview",link:function(e,t,n,r){t.bind("load",r.show_on_loaded)}}}).directive("showCenterOnLoaded",function(){return{restrict:"A",require:"^imageview",link:function(e,t,n,r){t.bind("load",r.show_center_on_loaded)}}}),angular.module("Wifi").directive("dribehanceHeader",function(){return{restrict:"E",templateUrl:"templates/header.html",scope:{title:"=",backAction:"="},link:function(){}}}),angular.module("Wifi").directive("dribehanceFooter",function(){return{restrict:"E",templateUrl:"templates/footer.html",scope:{active:"="},link:function(){}}}),angular.module("Wifi").directive("errSrc",function(){return{restrict:"A",link:function(e,t,n){$(t).bind("error",function(){$(t).attr("src",n.errSrc)})}}}),angular.module("Wifi").directive("countdown",["$interval",function(e){return{restrict:"E",scope:{countdown:"=",disabled:"=countdownDisabled"},link:function(t,n){function r(){var n=t.countdown.message,r=parseFloat(t.countdown.count)?parseFloat(t.countdown.count):60;o=!0,t.$apply(function(){t.countdown.message=r--,t.countdown.message=r+"s重新获取",t.countdown.mode="disabled",t.countdown.reset=!1,t.countdown.callback()});var i=e(function(){t.countdown.message=r--,t.countdown.message=r+"s重新获取",(0>r||t.countdown.reset)&&(e.cancel(i),t.countdown.message=n,o=!1)},1e3)}var o=!1;$(n).bind("click",function(){t.disabled||o||r()})}}}]),angular.module("Wifi").directive("confirm",function(){return{restrict:"E",scope:{confirm:"="},templateUrl:"templates/confirm.html",link:function(e,t){e.confirm=angular.extend({},{title:"Tips",content:"Are You Sure?",content_type:"content",open:function(){$(t).show()},cancel:function(){$(t).hide(),"function"==typeof e.confirm.cancle_callback&&e.confirm.cancle_callback()},ok:function(){$(t).hide(),"function"==typeof e.confirm.ok_callback&&(e.confirm.ok_callback(),e.confirm.content_type="content")}},e.confirm)}}}),angular.module("Wifi").directive("banner",function(){return{restrict:"E",transclude:!0,template:"<div class='carousel-holder owl-carousel theme' ng-transclude></div>",link:function(e,t){var n={autoplay:!0,items:1};n=angular.extend({},n,e.$eval($(t).attr("data-options")));var r=parseFloat(e.$eval($(t).attr("data-rate"))),o={display:"block",width:$(t).parent().width()||$(window).width(),height:($(t).parent().width()||$(window).width())/r};$(t).css(o),e.$on("onRepeatDone",function(){$(t).find(".carousel-holder").owlCarousel(n)})}}}),angular.module("Wifi").controller("tringController",["$scope","errorServices","toastServices","localStorageService","config",function(){}]),angular.module("Wifi").controller("trialController",["$scope","errorServices","toastServices","localStorageService","config",function(){}]),angular.module("Wifi").controller("indexController",["$scope","errorServices","toastServices","localStorageService","config",function(){}]),angular.module("Wifi").constant("config",{url:"http://",imageUrl:"http://",request:{SUCCESS:"200",TOKEN_INVALID:"405"},response:{SUCCESS:1},common_params:{},interceptor:["index","trial","tring"]});
//# sourceMappingURL=app.min.js.map
